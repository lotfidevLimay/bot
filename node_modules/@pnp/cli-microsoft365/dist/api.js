"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.executeCommand = void 0;
const Cli_1 = require("./cli/Cli");
const path = require("path");
function executeCommand(commandName, options, listener) {
    const cli = Cli_1.Cli.getInstance();
    cli.commandsFolder = path.join(__dirname, 'm365');
    cli.commands = [];
    cli.loadCommandFromArgs(commandName.split(' '));
    if (cli.commands.length !== 1) {
        return Promise.reject(`Command not found: ${commandName}`);
    }
    return Cli_1.Cli.executeCommandWithOutput(cli.commands[0].command, { options: options !== null && options !== void 0 ? options : {} }, listener);
}
exports.executeCommand = executeCommand;
//# sourceMappingURL=api.js.map