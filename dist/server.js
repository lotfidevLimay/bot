(()=>{"use strict";var e={64:function(e,t,i){var o=this&&this.__createBinding||(Object.create?function(e,t,i,o){void 0===o&&(o=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,o,n)}:function(e,t,i,o){void 0===o&&(o=i),e[o]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||o(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.nonce=void 0,t.nonce={},n(i(789),t)},789:function(e,t,i){var o=this&&this.__decorate||function(e,t,i,o){var n,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(s=(a<3?n(s):a>3?n(t,i,s):n(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DemoBotBot=void 0;const a=i(698),s=i(974),r=i(58),c=i(306),l=i(288),d=i(32);s("msteams");let p=class extends c.DialogBot{constructor(e,t){super(e,t,new l.MainDialog),this.onMembersAdded(((e,t)=>n(this,void 0,void 0,(function*(){const i=e.activity.membersAdded;if(i&&i.length>0)for(let t=0;t<i.length;t++)i[t].id!==e.activity.recipient.id&&(yield this.sendWelcomeCard(e));yield t()}))))}sendWelcomeCard(e){return n(this,void 0,void 0,(function*(){const t=r.CardFactory.adaptiveCard(d.default);yield e.sendActivity({attachments:[t]})}))}};p=o([(0,a.BotDeclaration)("/api/messages",new r.MemoryStorage,process.env.MICROSOFT_APP_ID,process.env.MICROSOFT_APP_PASSWORD)],p),t.DemoBotBot=p},32:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=i(681);t.default=o},306:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DialogBot=void 0;const n=i(58);class a extends n.TeamsActivityHandler{constructor(e,t,i){super(),this.conversationState=e,this.userState=t,this.dialog=i,this.conversationState=e,this.userState=t,this.dialog=i,this.dialogState=this.conversationState.createProperty("DialogState"),this.onMessage(((e,t)=>o(this,void 0,void 0,(function*(){yield this.dialog.run(e,this.dialogState),yield t()})))),this.onMessageReaction(((e,t)=>o(this,void 0,void 0,(function*(){const t=e.activity.reactionsAdded;t&&t[0]&&(yield e.sendActivity({textFormat:"xml",text:`Thanks for reacting to my message (${t[0].type})`}))}))))}run(e){const t=Object.create(null,{run:{get:()=>super.run}});return o(this,void 0,void 0,(function*(){yield t.run.call(this,e),yield this.conversationState.saveChanges(e,!1),yield this.userState.saveChanges(e,!1)}))}}t.DialogBot=a},404:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.HelpDialog=void 0;const n=i(883),a=i(58),s=i(98),r="helpWaterfallDialog";class c extends n.ComponentDialog{constructor(){super("helpDialog"),this.addDialog(new n.TextPrompt("TextPrompt")).addDialog(new n.WaterfallDialog(r,[this.introStep.bind(this)])),this.initialDialogId=r}run(e,t){return o(this,void 0,void 0,(function*(){const i=new n.DialogSet(t);i.add(this);const o=yield i.createContext(e);(yield o.continueDialog()).status===n.DialogTurnStatus.empty&&(yield o.beginDialog(this.id))}))}introStep(e){return o(this,void 0,void 0,(function*(){const t=a.CardFactory.adaptiveCard(s.default),i={type:a.ActivityTypes.Message,attachments:[t]};return yield e.context.sendActivity(i),yield e.endDialog()}))}}t.HelpDialog=c},288:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MainDialog=void 0;const n=i(883),a=i(58),s=i(78),r=i(404),c=i(451),l=i(240),d=i(959),p="mainWaterfallDialog";class u extends n.ComponentDialog{constructor(){super("mainDialog"),this.addDialog(new n.TextPrompt("TextPrompt")).addDialog(new s.TeamsInfoDialog).addDialog(new r.HelpDialog).addDialog(new c.MentionUserDialog).addDialog(new n.WaterfallDialog(p,[this.introStep.bind(this),this.actStep.bind(this),this.finalStep.bind(this)])),this.initialDialogId=p,this.onboarding=!1}run(e,t){return o(this,void 0,void 0,(function*(){const i=new n.DialogSet(t);i.add(this);const o=yield i.createContext(e);(yield o.continueDialog()).status===n.DialogTurnStatus.empty&&(yield o.beginDialog(this.id))}))}introStep(e){return o(this,void 0,void 0,(function*(){if(e.options.restartMsg){const t=e.options.restartMsg?e.options.restartMsg:"What can I help you with today?",i=a.MessageFactory.text(t,t,a.InputHints.ExpectingInput);return yield e.prompt("TextPrompt",{prompt:i})}return this.onboarding=!0,yield e.next()}))}actStep(e){return o(this,void 0,void 0,(function*(){if(e.result){const t=e.result.trim().toLocaleLowerCase();if(d.textCommands.includes(t)){const i=(0,l.getDataByCommandId)(t);yield e.context.sendActivity((0,d.getCard)(i,t))}else switch(t){case"who":case"who am i?":return yield e.beginDialog("teamsInfoDialog");case"get help":case"help":return yield e.beginDialog("helpDialog");case"mention me":case"mention":return yield e.beginDialog("mentionUserDialog");case"call api":case"api":return yield e.beginDialog("externalApiDialog");default:return yield e.context.sendActivity("Ok, maybe next time ðŸ˜‰"),yield e.next()}}else if(this.onboarding){const t=e.context.activity.text.trim().toLocaleLowerCase();if(d.textCommands.includes(t)){const i=(0,l.getDataByCommandId)(t);yield e.context.sendActivity((0,d.getCard)(i,t))}else switch(t){case"who":return yield e.beginDialog("teamsInfoDialog");case"help":return yield e.beginDialog("helpDialog");case"mention":return yield e.beginDialog("mentionUserDialog");case"api":return yield e.beginDialog("externalApiDialog");default:return yield e.context.sendActivity("Ok, maybe next time ðŸ˜‰"),yield e.next()}}return yield e.next()}))}finalStep(e){return o(this,void 0,void 0,(function*(){return yield e.endDialog(this.initialDialogId)}))}}t.MainDialog=u},451:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MentionUserDialog=void 0;const n=i(883),a=i(58),s="mentionUserWaterfallDialog";class r extends n.ComponentDialog{constructor(){super("mentionUserDialog"),this.addDialog(new n.TextPrompt("TextPrompt")).addDialog(new n.WaterfallDialog(s,[this.introStep.bind(this)])),this.initialDialogId=s}run(e,t){return o(this,void 0,void 0,(function*(){const i=new n.DialogSet(t);i.add(this);const o=yield i.createContext(e);(yield o.continueDialog()).status===n.DialogTurnStatus.empty&&(yield o.beginDialog(this.id))}))}introStep(e){return o(this,void 0,void 0,(function*(){const t={mentioned:e.context.activity.from,text:`<at>${(new TextEncoder).encode(e.context.activity.from.name)}</at>`,type:"mention"},i=a.MessageFactory.text(`Hi ${t.text}`);return i.entities=[t],yield e.context.sendActivity(i),yield e.endDialog()}))}}t.MentionUserDialog=r},78:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TeamsInfoDialog=void 0;const n=i(883),a=i(58),s="teamsInfoWaterfallDialog";let r;class c extends n.ComponentDialog{constructor(){super("teamsInfoDialog"),this.addDialog(new n.TextPrompt("TextPrompt")).addDialog(new n.WaterfallDialog(s,[this.introStep.bind(this),this.actStep.bind(this),this.finalStep.bind(this)])),this.initialDialogId=s}run(e,t){return o(this,void 0,void 0,(function*(){const i=new n.DialogSet(t);i.add(this);const o=yield i.createContext(e);(yield o.continueDialog()).status===n.DialogTurnStatus.empty&&(yield o.beginDialog(this.id))}))}introStep(e){return o(this,void 0,void 0,(function*(){const t=a.MessageFactory.text("Do you want me to send you the current Teams member info?\n\nSay **yes** if you do like to see the context or **no** if you don't");return yield e.prompt("TextPrompt",{prompt:t})}))}actStep(e){return o(this,void 0,void 0,(function*(){if(e.result){if("yes"!==e.result)return yield e.context.sendActivity("Ok, maybe next time ðŸ˜‰"),yield e.next();r=yield a.TeamsInfo.getMember(e.context,e.context.activity.from.id),yield e.context.sendActivity(`Your name: **${r.name}**\n\nYour Teams ID: **${r.id}**\n\nYour email: **${r.email}**`)}return yield e.next()}))}finalStep(e){return o(this,void 0,void 0,(function*(){return yield e.context.sendActivity("Now it's time to add more functionality to your bot, so head over to the [docs](https://aka.ms/yoTeams) and start building"),yield e.endDialog()}))}}t.TeamsInfoDialog=c},98:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});const o={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.0",type:"AdaptiveCard",speak:"Your flight is confirmed for you and 3 other passengers from San Francisco to Amsterdam on Friday, October 10 8:30 AM",msteams:{width:"Full"},body:[{type:"TextBlock",text:"Command list",weight:"bolder",isSubtle:!1},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:1,items:[{type:"TextBlock",text:'get info "ap24563"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the features of the app code",size:"default",weight:"lighter"}]}]},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:1,items:[{type:"TextBlock",text:'get inc "ap24563"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the open incident of the code ap",size:"default",weight:"lighter"}]}]},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:1,items:[{type:"TextBlock",text:'get inc last "ap24563"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the latest incidents in the app code from the last 90 days",size:"default",weight:"lighter"}]}]},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:1,items:[{type:"TextBlock",text:'get info "inc (priority: P1)"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the details of the incident by priority",size:"default",weight:"lighter"}]}]},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:1,items:[{type:"TextBlock",text:'get chg "ap24563"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the open change of the code ap",size:"default",weight:"lighter"}]}]},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:"1",items:[{type:"TextBlock",text:'get chg last "ap24563"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the latest changes in the app code from the last 90 days",size:"default",weight:"lighter"}]}]},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:1,items:[{type:"TextBlock",text:'get info "chg (Id)"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the details of the chnage by id",size:"default",weight:"lighter"}]}]},{type:"ColumnSet",spacing:"medium",columns:[{type:"Column",width:1,items:[{type:"TextBlock",text:'get info "server (Id)"',size:"medium",weight:"bolder",isSubtle:!0}]},{type:"Column",width:1,items:[{type:"TextBlock",horizontalAlignment:"left",text:"List the details of the server by id",size:"default",weight:"lighter"}]}]}]}},240:(e,t,i)=>{i.r(t),i.d(t,{commands:()=>r,getDataByCommandId:()=>c});const o=[{id:"INC6213608",priority:"P2",state:"New",shortDescription:"Les utilisateurs ne reÃ§oivent plus de notifications dans l'application mobile",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",openedAt:"24/08/2023 At 11:52",closedAt:null,cmdbCiId:"401f102f1b24e810704d8055464bcbe3"},{id:"INC6213606",priority:"P3",state:"New",shortDescription:"Le serveur semble down, il est inaccessible (SRV001)",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",openedAt:"24/08/2023 At 10:20",closedAt:null,cmdbCiId:"14fcc1fe1be424100e2940c1b24bcb6e"},{id:"INC6213607",priority:"P4",state:"New",shortDescription:"Lenteur serveur, le seuil d'usage du CPU est dÃ©passÃ©",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",openedAt:"24/08/2023 At 12:00",closedAt:null,cmdbCiId:"36d9013e1b6424100e2940c1b24bcb8e"}],n=[{id:"CHG0537388",type:"Normal",state:"Implement",openedAt:"24/08/2023 At 14:00",closedAt:null,group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",shortDescription:"DÃ©ploiement patch sÃ©curitÃ© RHEL-Lot 1-S33 sur le server SRV001",cmdbCiId:"2371f55187ecb0d0eb9033fd3fbb352d",server:"SRV001"},{id:"CHG0537386",type:"Normal",state:"Closed",openedAt:"24/08/2023 At 18:00",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",shortDescription:"DÃ©ploiement patch sÃ©curitÃ© RHEL-Lot 1-S33",cmdbCiId:"14fcc1fe1be424100e2940c1b24bcb6e",server:"SRV001"},{id:"CHG0537387",type:"Normal",state:"New",openedAt:"24/08/2023 At 16:00",closedAt:null,group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",shortDescription:"DÃ©ploiement patch sÃ©curitÃ© RHEL-Lot 1-S33",cmdbCiId:"36d9013e1b6424100e2940c1b24bcb8e",server:"SRV001"}],a=e=>{const t=e.trim().toLocaleLowerCase();return o.find((e=>e.priority.trim().toLocaleLowerCase()===t))},s=e=>{const t=e.trim().toLocaleLowerCase();return n.find((e=>e.id.trim().toLocaleLowerCase()===t))},r=[{id:'get info "ap24563"',data:{id:"AP24563",name:"AP24563 -- COCKPIT-ITG",label:"COCKPIT-ITG",owner:"Fabrice LE DEIT",responsible:"David ELIASZ",group:"BNPP_ITGP_DATA_COCKPIT",description:"Cockpit is an IT Operations Analytics product offering an interactive data visualisation tool on incidents to facilitate investigations, It is an advanced reporting offering muli dimensional views: Applications, Metiers, Teams, Time."},type:"application",mode:"one"},{id:'get info "server (SRV001)"',data:{id:"SRV001",label:"SRV001 -- SERVER-ITG",group:"BNPP_ITGP_DATA_COCKPIT",processor:"AMD",time:"0 Days, 6 Hours and 43 Minutes",hostname:"S01123456789",provisor:"BP2I",infra:"IBM",infratype:"DMZR_IAAS_VMW",ownertype:"DAT -ITGP",code:"AP24563",osdomaine:"linux",osversion:"7.9",operatingsys:"RHEL"},type:"server",mode:"one"},{id:'get inc "ap24563"',data:o,type:"incident"},{id:'get inc last "ap24563"',data:[{id:"INC6213607",priority:"P4",state:"New",shortDescription:"Lenteur serveur, le seuil d'usage du CPU est dÃ©passÃ©",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",openedAt:"24/08/2023 At 12:00",closedAt:null,cmdbCiId:"36d9013e1b6424100e2940c1b24bcb8e"},{id:"INC6213608",priority:"P2",state:"New",shortDescription:"Les utilisateurs ne reÃ§oivent plus de notifications dans l'application mobile",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",openedAt:"24/08/2023 At 11:52",closedAt:null,cmdbCiId:"401f102f1b24e810704d8055464bcbe3"},{id:"INC6213606",priority:"P3",state:"New",shortDescription:"Le serveur semble down, il est inaccessible (SRV001)",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",openedAt:"24/08/2023 At 10:20",closedAt:null,cmdbCiId:"14fcc1fe1be424100e2940c1b24bcb6e"}],type:"incident",mode:"multiple"},{id:'get info "inc (P2)"',data:a("P2"),type:"incident",mode:"one"},{id:'get info "inc (P3)"',data:a("P3"),type:"incident",mode:"one"},{id:'get info "inc (P4)"',data:a("P4"),type:"incident",mode:"one"},{id:'get chg "ap24563"',data:n.filter((e=>"Implement"===e.state)),type:"change",mode:"multiple"},{id:'get chg last "ap24563"',data:[{id:"CHG0537386",type:"Normal",state:"Closed",openedAt:"24/08/2023 At 18:00",group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",shortDescription:"DÃ©ploiement patch sÃ©curitÃ© RHEL-Lot 1-S33",cmdbCiId:"14fcc1fe1be424100e2940c1b24bcb6e",server:"SRV001"},{id:"CHG0537387",type:"Normal",state:"New",openedAt:"24/08/2023 At 16:00",closedAt:null,group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",shortDescription:"DÃ©ploiement patch sÃ©curitÃ© RHEL-Lot 1-S33",cmdbCiId:"36d9013e1b6424100e2940c1b24bcb8e",server:"SRV001"},{id:"CHG0537388",type:"Normal",state:"Implement",openedAt:"24/08/2023 At 14:00",closedAt:null,group:"bnpp itgp data cockpit",service:"AP24563 -- COCKPIT-ITG",shortDescription:"DÃ©ploiement patch sÃ©curitÃ© RHEL-Lot 1-S33",cmdbCiId:"2371f55187ecb0d0eb9033fd3fbb352d",server:"SRV001"}],type:"change",mode:"multiple"},{id:'get info "chg (CHG0537386)"',data:s("CHG0537386"),type:"change",mode:"one"},{id:'get info "chg (CHG0537387)"',data:s("CHG0537387"),type:"change",mode:"one"},{id:'get info "chg (CHG0537388)"',data:s("CHG0537388"),type:"change",mode:"one"}],c=e=>{const t=e.trim().toLocaleLowerCase();return r.find((e=>e.id.trim().toLocaleLowerCase()===t))}},959:(e,t,i)=>{i.r(t),i.d(t,{getCard:()=>p,textCommands:()=>n});var o=i(58);const n=['get info "ap24563"','get inc "ap24563"','get inc last "ap24563"','get info "inc (p2)"','get info "inc (p3)"','get info "inc (p4)"','get chg "ap24563"','get chg last "ap24563"','get info "chg (chg0537386)"','get info "chg (chg0537387)"','get info "chg (chg0537388)"','get info "chg (chg0537388)"','get info "server (srv001)"'],a=e=>({msteams:{width:"Full"},type:"AdaptiveCard",body:[{type:"Container",items:[{type:"ColumnSet",columns:[{type:"Column",width:"100px",items:[{type:"TextBlock",text:"Label",wrap:!0,weight:"Bolder"},{type:"TextBlock",text:"Owner",wrap:!0,weight:"Bolder"},{type:"TextBlock",text:"IT Responsible",wrap:!0,weight:"Bolder"},{type:"TextBlock",text:"Group",wrap:!0,weight:"Bolder"},{type:"TextBlock",text:"Description",wrap:!0,weight:"Bolder"}]},{type:"Column",items:[{type:"TextBlock",text:e.label},{type:"TextBlock",text:e.owner,wrap:!0},{type:"TextBlock",text:e.responsible},{type:"TextBlock",text:e.group,wrap:!0},{type:"TextBlock",text:e.description,wrap:!0}]}]}]}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.6",fallbackText:"This card requires Adaptive Cards v1.5 support to be rendered properly."}),s=e=>({msteams:{width:"Full"},type:"AdaptiveCard",body:[{type:"Container",items:[{type:"FactSet",spacing:"Padding",facts:[{title:"Server Id",value:e.id},{title:"Code AP",value:e.code},{title:"Host Name",value:e.hostname},{title:"Infra",value:e.infra},{title:"Hyper Visor Provider",value:e.provisor},{title:"Processor",value:e.processor},{title:"Owner OU Name",value:e.ownertype},{title:"OS Domaine",value:e.osdomaine},{title:"OS Version",value:e.osversion},{title:"Operating Systeme",value:e.operatingsys},{title:"label",value:e.label},{title:"Group",value:e.group},{title:"Up Time",value:e.time}]}]}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.6",fallbackText:"This card requires Adaptive Cards v1.5 support to be rendered properly."}),r=e=>{switch(e){case"P1":case"P2":return"https://img.icons8.com/?size=2x&id=21181&format=png";case"P3":return"https://img.icons8.com/?size=2x&id=12368&format=png";case"P4":return"https://img.icons8.com/?size=2x&id=21193&format=png"}},c=e=>{switch(e){case"New":return"https://img.icons8.com/?size=2x&id=21517&format=png";case"Implement":return"https://img.icons8.com/?size=2x&id=81438&format=png";case"Closed":return"https://img.icons8.com/?size=2x&id=38006&format=png"}},l=(e,t)=>({type:"AdaptiveCard",body:[{type:"Container",style:"emphasis",items:[{type:"ColumnSet",columns:[{type:"Column",items:[{type:"TextBlock",size:"Default",weight:"Default",text:e.openedAt,style:"default",wrap:!0,fontType:"Default"},{type:"TextBlock",size:"Default",weight:"Bolder",text:e.id,style:"default",wrap:!0,fontType:"Default",spacing:"Small"}],width:"stretch"},{type:"Column",items:[{type:"ActionSet",actions:[{iconUrl:r(e.priority),type:"Action.Submit",title:e.priority}],size:"Stretch"}],width:"auto"}]}],bleed:!0},{type:"Container",items:[{type:"FactSet",spacing:"Padding",facts:t?[{title:"Group",value:e.group},{title:"Service",value:e.service},{title:"Short description",value:e.shortDescription}]:[{title:"Group",value:e.group},{title:"Service",value:e.service}]}]}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.6",fallbackText:"This card requires Adaptive Cards v1.5 support to be rendered properly."}),d=(e,t)=>({type:"AdaptiveCard",body:[{type:"Container",style:"emphasis",items:[{type:"ColumnSet",columns:[{type:"Column",items:[{type:"TextBlock",size:"Default",weight:"Default",text:e.openedAt,style:"default",wrap:!0,fontType:"Default"},{type:"TextBlock",size:"Default",weight:"Bolder",text:e.id,style:"default",wrap:!0,fontType:"Default",spacing:"Small"}],width:"stretch"},{type:"Column",items:[{type:"ActionSet",actions:[{iconUrl:c(e.state),type:"Action.Submit",title:e.state}],size:"Stretch"}],width:"auto"}]}],bleed:!0},{type:"Container",items:[{type:"FactSet",spacing:"Padding",facts:t?[{title:"Group",value:e.group},{title:"Service",value:e.service},{title:"Short description",value:e.shortDescription}]:[{title:"Group",value:e.group},{title:"Service",value:e.service}]}]}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.6",fallbackText:"This card requires Adaptive Cards v1.5 support to be rendered properly."}),p=(e,t)=>{const i=e.type,n=e.mode,r=e.data,c=t.includes("info");let p;if("incident"===i)if("one"===n)p={attachments:[o.CardFactory.adaptiveCard(l(r,c))]};else{const e=[];r.forEach((t=>{e.push(o.CardFactory.adaptiveCard(l(t,c)))})),p={attachments:e,attachmentLayout:o.AttachmentLayoutTypes.Carousel}}if("change"===i)if("one"===n)p={attachments:[o.CardFactory.adaptiveCard(d(r,c))]};else{const e=[];r.forEach((t=>{e.push(o.CardFactory.adaptiveCard(d(t,c)))})),p={attachments:e,attachmentLayout:o.AttachmentLayoutTypes.Carousel}}return"application"===i&&(p={attachments:[o.CardFactory.adaptiveCard(a(r))]}),"server"===i&&(p={attachments:[o.CardFactory.adaptiveCard(s(r))]}),p}},58:e=>{e.exports=require("botbuilder")},883:e=>{e.exports=require("botbuilder-dialogs")},455:e=>{e.exports=require("compression")},974:e=>{e.exports=require("debug")},142:e=>{e.exports=require("dotenv")},860:e=>{e.exports=require("express")},698:e=>{e.exports=require("express-msteams-host")},470:e=>{e.exports=require("morgan")},685:e=>{e.exports=require("http")},17:e=>{e.exports=require("path")},681:e=>{e.exports=JSON.parse('{"$schema":"http://adaptivecards.io/schemas/adaptive-card.json","type":"AdaptiveCard","version":"1.4","body":[{"type":"ColumnSet","columns":[{"type":"Column","width":"auto","items":[{"type":"Image","url":"https://chatbots.searchunify.com/wp-content/themes/searchunify/images/chatbots/chatbot-1.png","size":"Medium"}],"verticalContentAlignment":"Center","spacing":"Large"},{"type":"Column","width":"stretch","items":[{"type":"TextBlock","spacing":"Medium","size":"Large","weight":"Bolder","text":"Welcome to Cockpit Bot","wrap":true,"maxLines":0},{"type":"TextBlock","size":"default","text":"Hello, Cockpit Team! I\'m Cockpit Bot created to assist you ðŸ˜€","wrap":true,"maxLines":0}]}]},{"type":"ActionSet","actions":[{"type":"Action.OpenUrl","title":"Learn more about Yo Teams","url":"https://aka.ms/yoteams"},{"type":"Action.OpenUrl","title":"Learn more about bots in Teams","url":"https://docs.microsoft.com/en-us/microsoftteams/platform/bots/what-are-bots"}],"height":"stretch","horizontalAlignment":"Center"},{"type":"ActionSet","actions":[{"type":"Action.Submit","title":"Get help","data":{"msteams":{"type":"messageBack","displayText":"get help","text":"help"}}}]}]}')}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=i(860),t=i(685),o=i(17),n=i(470),a=i(698),s=i(974),r=i(455),c=s("msteams");c("Initializing Microsoft Teams Express hosted App..."),i(142).config();const l=i(64),d=e(),p=process.env.port||process.env.PORT||3007;d.use(e.json({verify:(e,t,i,o)=>{e.rawBody=i.toString()}})),d.use(e.urlencoded({extended:!0})),d.set("views",o.join(__dirname,"/")),d.use(n("tiny")),d.use(r()),d.use("/scripts",e.static(o.join(__dirname,"web/scripts"))),d.use("/assets",e.static(o.join(__dirname,"web/assets"))),d.use((0,a.MsTeamsApiRouter)(l)),d.use((0,a.MsTeamsPageRouter)({root:o.join(__dirname,"web/"),components:l})),d.use("/",e.static(o.join(__dirname,"web/"),{index:"index.html"})),d.set("port",p),t.createServer(d).listen(p,(()=>{c(`Server running on ${p}`)}))})()})();
//# sourceMappingURL=server.js.map